# üóìÔ∏è Daily Log ‚Äì 2025-11-07

**Focus:** Polynomial Linear Regression

## üß† What I Learned

- Polynomial Linear Regression Implementation

- The Typical Production Workflow:
  
  The most common way scikit-learn is used in production isn't by "running" the library on a live server, but by deploying models that were built with it.

  1. Offline Training: A data scientist uses scikit-learn (and pandas/NumPy) in a notebook or script to train a model. They often use GridSearchCV to find the best parameters and build a Pipeline object.

  2. Serialization: The final, trained Pipeline object is saved to a single file using a library like joblib or pickle.

  3. Deployment: This model file (e.g., model.joblib) is then loaded into a production application. This is often a simple Python web server (using FastAPI or Flask) that wraps the model in a REST API.


  4. Inference: When the application gets a new request (e.g., a user's new data), it loads the data, passes it to the loaded model's .predict() method, and sends the resulting prediction back as an API response.

- Host and run the model in non-python env: 
  1. ONNX. cons: model conversion can be complicated
  2. Python Microservice - API response. cons: slight network latency from the HTTP call

- Model Inference
  - Traning: study & prepare for an exam. 
  - Inference: a real exact.

## üíª Snippet / Command

```py
import numpy as np
import matplotlib.pyplot as plt
from sklearn.linear_model import LinearRegression
from sklearn.preprocessing import PolynomialFeatures
from sklearn.pipeline import Pipeline
from sklearn.metrics import mean_squared_error, r2_score

# --- 1. Generate Sample Data ---
# We'll create some non-linear data based on a quadratic equation
# y = 0.5*x^2 + 1*x + 2 + noise

# Set a random seed for reproducibility
np.random.seed(42)

# Generate 100 data points
m = 100
X = 6 * np.random.rand(m, 1) - 3  # X values from -3 to 3
y = 0.5 * X**2 + X + 2 + np.random.randn(m, 1) # y values with noise

# Sort X and y for plotting the curve later
sort_indices = np.argsort(X, axis=0)
X = X[sort_indices].reshape(m, 1)
y = y[sort_indices].reshape(m, 1)

# --- 2. Create and Train the Model ---

# Define the degree of the polynomial
degree = 2

# We use a Pipeline to chain the steps together:
# 1. PolynomialFeatures: Adds polynomial features (e.g., x -> [1, x, x^2])
# 2. LinearRegression: Fits a linear model to these new features
polynomial_regression = Pipeline([
    ("poly_features", PolynomialFeatures(degree=degree, include_bias=False)),
    ("lin_reg", LinearRegression()),
])

# Train the model
polynomial_regression.fit(X, y)

# --- 3. Make Predictions and Evaluate ---

# Generate new X values to plot the fitted curve
X_new = np.linspace(-3, 3, 100).reshape(100, 1)
y_new = polynomial_regression.predict(X_new)

# Make predictions on the training data to evaluate
y_pred = polynomial_regression.predict(X)

# Calculate metrics
mse = mean_squared_error(y, y_pred)
r2 = r2_score(y, y_pred)

print(f"--- Polynomial Regression (Degree {degree}) ---")
print(f"Mean Squared Error (MSE): {mse:.2f}")
print(f"R-squared (R2): {r2:.2f}")

# You can also inspect the coefficients
# Note: The 'lin_reg' step in the pipeline contains the model
lin_reg_model = polynomial_regression.named_steps['lin_reg']
print(f"Coefficients (for x, x^2): {lin_reg_model.coef_}")
print(f"Intercept: {lin_reg_model.intercept_}")
# The true values were [1, 0.5] and 2. The model should be close!

# --- 4. Visualize the Results ---
plt.figure(figsize=(10, 6))
# Plot the original data points
plt.scatter(X, y, color='blue', label="Data points", alpha=0.7)
# Plot the fitted polynomial curve
plt.plot(X_new, y_new, "r-", linewidth=2, label=f"Fitted (Degree {degree})")

plt.title("Polynomial Linear Regression Demo")
plt.xlabel("X")
plt.ylabel("y")
plt.legend()
plt.grid(True)
plt.show()
```

‚ö†Ô∏è Speed-Bump / Question

- how to build Real-time Machine Learning: Architecture and Challenges
https://www.youtube.com/watch?v=S4A8QWN1G7s

üîó Links / References

- https://www.upgrad.com/blog/scikit-learn-in-python/

- ML deployments
- https://www.youtube.com/watch?v=vA0C0k72-b4
- https://www.youtube.com/watch?v=oYlNP21g2Y0
- https://www.youtube.com/watch?v=pJ_nCklQ65w

Python Mindmap
- https://orgpad.info/s/sbwXdJ9N5wc